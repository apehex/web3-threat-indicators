"""Test bytecode parsing."""

import pytest

import forta_toolkit.parsing.common as fpc
import ioseeth.parsing.bytecode as ipc

# FIXTURES ####################################################################

RAW = '0x608060405234801561001057600080fd5b50600436106100415760003560e01c80631c4695f4146100465780633d7403a3146100645780636d4ce63c14610080575b600080fd5b61004e61009e565b60405161005b9190610314565b60405180910390f35b61007e6004803603810190610079919061047f565b61012c565b005b610088610146565b6040516100959190610314565b60405180910390f35b600080546100ab906104f7565b80601f01602080910402602001604051908101604052809291908181526020018280546100d7906104f7565b80156101245780601f106100f957610100808354040283529160200191610124565b820191906000526020600020905b81548152906001019060200180831161010757829003601f168201915b505050505081565b80600090805190602001906101429291906101d8565b5050565b606060008054610155906104f7565b80601f0160208091040260200160405190810160405280929190818152602001828054610181906104f7565b80156101ce5780601f106101a3576101008083540402835291602001916101ce565b820191906000526020600020905b8154815290600101906020018083116101b157829003601f168201915b5050505050905090565b8280546101e4906104f7565b90600052602060002090601f016020900481019282610206576000855561024d565b82601f1061021f57805160ff191683800117855561024d565b8280016001018555821561024d579182015b8281111561024c578251825591602001919060010190610231565b5b50905061025a919061025e565b5090565b5b8082111561027757600081600090555060010161025f565b5090565b600081519050919050565b600082825260208201905092915050565b60005b838110156102b557808201518184015260208101905061029a565b838111156102c4576000848401525b50505050565b6000601f19601f8301169050919050565b60006102e68261027b565b6102f08185610286565b9350610300818560208601610297565b610309816102ca565b840191505092915050565b6000602082019050818103600083015261032e81846102db565b905092915050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61038c826102ca565b810181811067ffffffffffffffff821117156103ab576103aa610354565b5b80604052505050565b60006103be610336565b90506103ca8282610383565b919050565b600067ffffffffffffffff8211156103ea576103e9610354565b5b6103f3826102ca565b9050602081019050919050565b82818337600083830152505050565b600061042261041d846103cf565b6103b4565b90508281526020810184848401111561043e5761043d61034f565b5b610449848285610400565b509392505050565b600082601f8301126104665761046561034a565b5b813561047684826020860161040f565b91505092915050565b60006020828403121561049557610494610340565b5b600082013567ffffffffffffffff8111156104b3576104b2610345565b5b6104bf84828501610451565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061050f57607f821691505b60208210811415610523576105226104c8565b5b5091905056fea264697066735822122014c357c4501b2214feba94e456acc1333edfefe021426146d970ef3a848545a864736f6c634300080a0033'

# GENERIC #####################################################################

def test_differentiate_hexstr_from_opcodes():
	assert fpc.is_hexstr(RAW)
	assert not fpc.is_hexstr(' ')
