import pytest

import ioseeth.indicators.redpill as iir

# FIXTURES ####################################################################

@pytest.fixture
def redpill_contract_bytecode() -> tuple:
	return (
		'608060405234801561000f575f80fd5b506101618061001d5f395ff3fe608060405234801561000f575f80fd5b5060043610610034575f3560e01c806346f2238414610038578063773a54d014610056575b5f80fd5b610040610074565b60405161004d9190610112565b60405180910390f35b61005e610099565b60405161006b9190610112565b60405180910390f35b5f80440361008b576100846100ea565b9050610096565b6100936100f2565b90505b90565b5f8073ffffffffffffffffffffffffffffffffffffffff164173ffffffffffffffffffffffffffffffffffffffff16036100dc576100d56100ea565b90506100e7565b6100e46100f2565b90505b90565b5f6001905090565b5f600a905090565b5f819050919050565b61010c816100fa565b82525050565b5f6020820190506101255f830184610103565b9291505056fea2646970667358221220a6c588baf55bf4fb0a5541c54e1f594173cd40338423070a65524c22bc252f2864736f6c63430008160033', # version 0.8.22
		'608060405234801561001057600080fd5b50610124806100206000396000f3fe6080604052348015600f57600080fd5b506004361060325760003560e01c806346f22384146037578063773a54d0146053575b600080fd5b603d606f565b6040518082815260200191505060405180910390f35b60596090565b6040518082815260200191505060405180910390f35b600080441415608457607e60dd565b9050608d565b608a60e6565b90505b90565b60008073ffffffffffffffffffffffffffffffffffffffff164173ffffffffffffffffffffffffffffffffffffffff16141560d15760cb60dd565b905060da565b60d760e6565b90505b90565b60006001905090565b6000600a90509056fea265627a7a723158206a05bc3c0ef74e293688f113aef9ec20f6360e3ef5367afc4108b19492eaaeb564736f6c63430005100032', # version 0.5.16
		'608060405234801561001057600080fd5b50610125806100206000396000f3fe6080604052348015600f57600080fd5b506004361060325760003560e01c806346f22384146037578063773a54d0146053575b600080fd5b603d606f565b6040518082815260200191505060405180910390f35b60596090565b6040518082815260200191505060405180910390f35b600080441415608457607e60dd565b9050608d565b608a60e6565b90505b90565b60008073ffffffffffffffffffffffffffffffffffffffff164173ffffffffffffffffffffffffffffffffffffffff16141560d15760cb60dd565b905060da565b60d760e6565b90505b90565b60006001905090565b6000600a90509056fea2646970667358221220736e66812e3d6b2d2cd8899e3221bef3c42c466de94912645643cce30a0eaf1f64736f6c63430006090033',) # version 0.6.9

# COINBASE TESTS ##############################################################

def test_indicators_detect_basic_test_on_coinbase(redpill_contract_bytecode):
	assert all(iir.bytecode_has_coinbase_test(bytecode=__b) for __b in redpill_contract_bytecode)

def test_indicators_detect_basic_test_on_difficulty(redpill_contract_bytecode):
	assert all(iir.bytecode_has_difficulty_test(bytecode=__b) for __b in redpill_contract_bytecode)
